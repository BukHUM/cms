# Security: Block access to version control directories and sensitive files
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Block access to version control directories
    RewriteRule ^\.(git|hg|svn|bzr|cvs)/ - [F,L]
    
    # Block access to sensitive files
    RewriteRule ^(composer\.(json|lock)|package\.(json|lock)|\.env|\.env\.example|artisan|phpunit\.xml|\.gitignore|\.gitattributes|README\.md|CHANGELOG\.md|LICENSE|\.editorconfig|\.styleci\.yml|\.php_cs|\.php_cs\.dist|\.travis\.yml|\.scrutinizer\.yml|\.codeclimate\.yml|\.github|\.gitlab-ci\.yml|\.dockerignore|Dockerfile|docker-compose\.yml|web\.config|robots\.txt|favicon\.ico)$ - [F,L]
    
    # Block access to sensitive directories
    RewriteRule ^(app|bootstrap|config|database|resources|routes|storage|tests|vendor|node_modules|\.idea|\.vscode|\.DS_Store)/ - [F,L]
    
    # Block access to Laravel specific files
    RewriteRule ^(artisan|server\.php|web\.config)$ - [F,L]
</IfModule>

# Additional security headers
<IfModule mod_headers.c>
    # Block access to sensitive file types
    <FilesMatch "\.(env|log|sql|bak|backup|old|tmp|temp)$">
        Order allow,deny
        Deny from all
    </FilesMatch>
    
    # Block access to version control files
    <FilesMatch "\.(git|hg|svn|bzr|cvs)$">
        Order allow,deny
        Deny from all
    </FilesMatch>
</IfModule>

# Disable directory browsing
Options -Indexes

# Block access to sensitive directories
<DirectoryMatch "\.(git|hg|svn|bzr|cvs)">
    Order allow,deny
    Deny from all
</DirectoryMatch>

<DirectoryMatch "(app|bootstrap|config|database|resources|routes|storage|tests|vendor|node_modules)">
    Order allow,deny
    Deny from all
</DirectoryMatch>
